{% extends 'main.html' %}
{% load static %}
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> <!-- Bootstrap CSS -->
    {% block css %}
    <style>
        /----------start promotions design--------------/
        .promo-container h1 {
            color: #000;
            font-size: 40px;
        }

        .promo-container {
            max-width: 90%;
            margin: 0 auto;
        }

        .promo {
            background-color: #7BDADE;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 9px 30px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer; /* Add pointer cursor */
            transition: background-color 0.3s ease; /* Smooth hover effect */
        }

        .promo:hover {
            background-color: #6AC8CC; /* Change background on hover */
        }

        .promo-header h2 {
            margin: 0;
            font-size: 28px;
            color: #000;
        }

        .promo-header p {
            color: #000;
            font-size: 20px;
            padding-left: 30px;
        }

        .promo-details p {
            margin: 5px 0;
            font-size: 20px;
        }

        .promo-price {
            display: flex;
            align-items: baseline;
            justify-content: flex-end;
            margin-top: 10px;
        }

        .promo-price .current-price {
            font-size: 24px;
            color: #000;
            font-weight: bold;
        }

        .info-icons {
            font-size: 24px;
            margin-bottom: 10px;
            padding-bottom: 30px;
        }

        .info-icons span {
            margin-right: 15px;
        }

        .info-icons span:before {
            content: "  ";
            margin-right: 5px;
        }
        /----------end promotions design--------------/

        /----------start modal design--------------/
        .modal-content {
            background-color: #F8F3E5; /* Modal background color */
            border-radius: 10px;
        }

        .modal-dialog {
            max-width: 600px; /* Increase modal width */
            margin: 1.75rem auto; /* Center the modal */
        }

        .modal-header {
            border-bottom: 1px solid #ddd;
        }

        .modal-title {
            color: #4B3F2F; /* Dark brown for title */
            font-weight: bold;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            border-top: 1px solid #ddd;
        }

        .btn-primary {
            background-color: #7C3F58; /* Submit button color */
            border-color: #7C3F58;
        }

        .btn-primary:hover {
            background-color: #6A354D; /* Darker shade on hover */
            border-color: #6A354D;
        }
        /----------end modal design--------------/
    </style>
    {% endblock %}
</head>
<body>
    {% block content %}
    <div class="promo-container">
        <h1>Purchase Coins</h1>
        {% if coins_promos %}
            <div class="info-icons">
                <span>ðŸª™ Coins</span>
                <span>ðŸ’Ž Bonus Coins</span>
            </div>

            {% for promo in coins_promos %}
                <div class="promo" data-bs-toggle="modal" data-bs-target="#promoModal" onclick="setPromoDetails('{{ promo.id }}','{{ promo.name }}', '{{ promo.description }}', '{{ promo.coins }}', '{{ promo.bonus_coins }}', '{{ promo.price }}')">
                    <div class="promo-header">
                        <h2>âœ¨ {{ promo.name }} âœ¨</h2>
                        <p>{{ promo.description }}</p>
                        <p>ðŸª™  {{ promo.coins }} + ðŸ’Ž {{ promo.bonus_coins }}</p>
                    </div>
                    <div class="promo-price">
                        <span class="current-price">{{ promo.price }} MRU</span>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p>No active promotions available at the moment.</p>
        {% endif %}
    </div>

<!-- Modal -->
    <div class="modal fade" id="promoModal" tabindex="-1" aria-labelledby="promoModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="promoModalLabel">Upload Payment Proof</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="promoDetails"></p>
                    <form id="uploadForm" method="post" action="{% url 'submit_payment_proof' %}" enctype="multipart/form-data">
                        {% csrf_token %}
                        <input type="hidden" id="promoId" name="promo_id"> <!-- Hidden input for promo ID -->
                        <div class="mb-3">
                            <label for="imageInput" class="form-label">Upload your payment proof (image):</label>
                            <input type="file" class="form-control" id="imageInput" name="image" accept="image/*" required>
                        </div>
                        <p class="text-muted">Instructions: Upload a clear image of your payment proof (e.g., screenshot of the transaction).</p>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" form="uploadForm" class="btn btn-primary">Submit</button>
                </div>
            </div>
        </div>
    </div>

<!--javascript-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> <!-- Bootstrap JS -->
    
    <script>
        // Function to set promo details in the modal
        function setPromoDetails(promoId, name, description, coins, bonusCoins, price) {
            const promoDetails = document.getElementById('promoDetails');
            promoDetails.innerHTML = `
                <strong>âœ¨ ${name} âœ¨</strong><br>
                ${description}<br>
                ðŸª™ ${coins} + ðŸ’Ž ${bonusCoins}<br>
                Price: ${price} MRU
            `;
            document.getElementById('promoId').value = promoId; // Set the promo ID in the hidden input
        }
    </script>

    {% endblock %}
</body>
</html>